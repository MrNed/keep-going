var Obstacle=function(a,b){this.posY=-80;var c=a.add.bitmapData(36,36);c.ctx.rect(0,0,36,36),"point"===b?(c.ctx.fillStyle="#4AA0D5",this.obstacleType=1):(c.ctx.fillStyle="#EB586F",this.obstacleType=0),c.ctx.fill(),Phaser.Sprite.call(this,a,0,this.posY,c),a.physics.arcade.enable(this),this.anchor.set(.5),this.body["static"]=!0,this.body.immovable=!0,this.exists=!1};Obstacle.prototype=Object.create(Phaser.Sprite.prototype),Obstacle.prototype.constructor=Obstacle,Obstacle.prototype.update=function(){this.y-this.body.halfHeight>game.height&&this.kill()},Obstacle.prototype.stop=function(){this.body.velocity.y=0},Obstacle.prototype.spawn=function(a,b){this.reset(a,this.posY),this.body.velocity.y=b};var Player=function(a,b,c){this.canMove=!0,this.pos=b,this.moveDuration=100;var d=a.add.bitmapData(18,18);d.ctx.rect(0,0,18,18),d.ctx.fillStyle="#D8E9F0",d.ctx.fill(),Phaser.Sprite.call(this,a,a.world.width*this.pos,c,d),a.physics.arcade.enable(this),this.anchor.set(.5),this.body["static"]=!0,this.body.allowRotation=!1,this.body.moves=!1,a.world.add(this)};Player.prototype=Object.create(Phaser.Sprite.prototype),Player.prototype.constructor=Player,Player.prototype.move=function(){var a=game.input.x<game.world.centerX?"left":"right";if(this.canMove){if("left"===a&&.25!==this.pos)this.pos-=.25;else{if("right"!==a||.75===this.pos)return!1;this.pos+=.25}this.canMove=!1,this.moveTween=game.add.tween(this).to({x:game.world.width*this.pos},this.moveDuration,Phaser.Easing.Linear.None,!0),this.moveTween.onComplete.add(function(){this.canMove=!0},this)}},Player.prototype.hit=function(){this.moveTween&&this.moveTween.stop(),this.canMove=!1},Player.prototype.incraseSpeed=function(){this.moveDuration>100&&(this.moveDuration-=.025)};var Spawn=function(a){Phaser.Group.call(this,a,a.world,"Spawn",!1,!0,Phaser.Physics.ARCADE),this.speed=500,this.delay=375,this.chanceForSecond=.8,this.nextSpawn=0;var b=0;for(b;10>b;b++)this.add(new Obstacle(a,"enemy"));return this.add(new Obstacle(a,"point")),this};Spawn.prototype=Object.create(Phaser.Group.prototype),Spawn.prototype.constructor=Spawn,Spawn.prototype.start=function(){if(this.posArr=[.25,.5,.75],!(this.game.time.time<this.nextSpawn)){var a=Math.floor(Math.random()*this.posArr.length);this.posX=this.posArr[a]*game.world.width,this.children.sort(function(){return.5-Math.random()}),this.getFirstExists(!1).spawn(this.posX,this.speed),Math.random()<=this.chanceForSecond&&(this.posArr.splice(a,1),this.getFirstExists(!1).spawn(this.posArr[Math.floor(Math.random()*this.posArr.length)]*game.world.width,this.speed)),this.nextSpawn=this.game.time.time+this.delay}},Spawn.prototype.stop=function(){this.forEach(function(a){a.stop()})};var BasicGame={};BasicGame.Boot=function(){},BasicGame.Boot.prototype={init:function(){this.input.maxPointers=1,this.stage.disableVisibilityChange=!0},preload:function(){this.load.atlas("preloader","res/preloader.png","res/preloader.json")},create:function(){this.stage.backgroundColor="#393E46",this.fontLoad=game.add.text(game.world.centerX,game.world.centerY," a ",{font:"200px",fill:"#fff"}),this.fontLoad.visible=!1,this.fontLoad.font="exo",this.state.start("Preload")}},BasicGame.Game=function(a){this.player=null,this.spawn=null,this.stop=!0,this.timer=null,this.spawnDelay=1e3,this.points=0},BasicGame.Game.prototype={init:function(a){this.config=a,game.renderer.roundPixels=!0,game.physics.startSystem(Phaser.Physics.ARCADE)},create:function(){var a=this;a.score=game.add.text(game.world.width-25,25,"0 ",{font:"24px",fill:"#D8E9F0"}),a.score.font="exo",a.score.anchor.setTo(.5),a.player=new Player(game,.5,game.world.height-64),a.spawn=new Spawn(game),game.input.onDown.add(a.player.move,a.player),a.timer=new Phaser.Timer(game),a.timer.add(a.spawnDelay,function(){a.stop=!1}),a.timer.start()},update:function(){var a=this;a.stop?a.timer.update(game.time.time):(a.spawn.start(),a.player.incraseSpeed(),game.physics.arcade.collide(a.player,a.spawn,function(b,c){1==c.obstacleType?a.getPoint(c):a.die()}))},shutdown:function(){game.input.onDown.removeAll(),game.time.events.remove(this.timer),this.player=null,this.spawn=null,this.stop=!0,this.points=0},die:function(){this.stop=!0,this.player.hit(),this.spawn.stop(),this.state.start("Game",!0,!1,this.config)},getPoint:function(a){a.kill(),this.points++,this.score.text=this.points.toString()},debugProperties:function(){var a=this;console.log(a.spawn.secondSpawnChance),console.log(a.spawn.spawnpeed),console.log(a.spawn.obstacleDelay),console.log(a.player.moveDuration)}},BasicGame.Menu=function(){},BasicGame.Menu.prototype={init:function(a){a||(a={}),this.config=a},create:function(){this.startClick()},update:function(){},startClick:function(){this.state.start("Game",!0,!1,this.config)}},BasicGame.Preload=function(){this.preloadBar=null,this.ready=!1},BasicGame.Preload.prototype={preload:function(){this.preloadBar=this.add.sprite(.5*game.width,.5*game.height,"preloader",0),this.preloadBar.anchor.set(.5,.5);var a=[],b=0;for(b;33>b;b++)a[b]=b;this.preloadBar.animations.add("loading",a,60,!0),this.preloadBar.play("loading"),this.load.onLoadComplete.addOnce(this.onLoadComplete,this)},create:function(){this.preloadBar.cropEnabled=!1},update:function(){this.state.start("Menu")},onLoadComplete:function(){this.ready=!0}};var game=new Phaser.Game(300,420,Phaser.AUTO,"game_cont");game.state.add("Boot",BasicGame.Boot),game.state.add("Preload",BasicGame.Preload),game.state.add("Menu",BasicGame.Menu),game.state.add("Game",BasicGame.Game),game.state.start("Boot");