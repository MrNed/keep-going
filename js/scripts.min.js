var Obstacle=function(a){this.posY=-80;var b=a.add.bitmapData(40,40);b.ctx.rect(0,0,40,40),b.ctx.fillStyle="#EB586F",b.ctx.fill(),Phaser.Sprite.call(this,a,0,this.posY,b),a.physics.arcade.enable(this),this.anchor.set(.5),this.body["static"]=!0,this.body.immovable=!0,this.exists=!1};Obstacle.prototype=Object.create(Phaser.Sprite.prototype),Obstacle.prototype.constructor=Obstacle,Obstacle.prototype.update=function(){this.y-this.body.halfHeight>game.height&&this.kill()},Obstacle.prototype.stop=function(){this.body.velocity.y=0},Obstacle.prototype.spawn=function(a,b){this.reset(a,this.posY),this.body.velocity.y=b};var Obstacles=function(a){Phaser.Group.call(this,a,a.world,"Obstacles",!1,!0,Phaser.Physics.ARCADE),this.obstacleSpeed=350,this.obstacleDelay=300,this.nextSpawn=0,this.minDelay=200,this.maxDelay=600;var b=0;for(b;10>b;b++)this.add(new Obstacle(a));return this};Obstacles.prototype=Object.create(Phaser.Group.prototype),Obstacles.prototype.constructor=Obstacles,Obstacles.prototype.spawn=function(){if(this.posArr=[.25,.5,.75],!(this.game.time.time<this.nextSpawn)){this.obstacleDelay=game.rnd.integerInRange(this.minDelay,this.maxDelay);var a=Math.floor(Math.random()*this.posArr.length);this.posX=this.posArr[a]*game.world.width,this.getFirstExists(!1).spawn(this.posX,this.obstacleSpeed),Math.random()<=.1&&(this.posArr.splice(a,1),this.getFirstExists(!1).spawn(this.posArr[Math.floor(Math.random()*this.posArr.length)]*game.world.width,this.obstacleSpeed)),this.obstacleSpeed+=1,this.maxDelay-=2,this.nextSpawn=this.game.time.time+this.obstacleDelay}},Obstacles.prototype.stop=function(){this.forEach(function(a){a.stop()})};var Player=function(a,b,c){this.canMove=!0,this.pos=b,this.moveDuration=200;var d=a.add.bitmapData(20,20);d.ctx.rect(0,0,20,20),d.ctx.fillStyle="#D8E9F0",d.ctx.fill(),Phaser.Sprite.call(this,a,a.world.width*this.pos,c,d),a.physics.arcade.enable(this),this.anchor.set(.5),this.body["static"]=!0,this.body.allowRotation=!1,this.body.moves=!1,a.world.add(this)};Player.prototype=Object.create(Phaser.Sprite.prototype),Player.prototype.constructor=Player,Player.prototype.move=function(){var a=game.input.x<game.world.centerX?"left":"right";if(this.canMove){if("left"===a&&.25!==this.pos)this.pos-=.25;else{if("right"!==a||.75===this.pos)return!1;this.pos+=.25}this.canMove=!1,this.moveTween=game.add.tween(this).to({x:game.world.width*this.pos},this.moveDuration,Phaser.Easing.Linear.None,!0),this.moveTween.onComplete.add(function(){this.canMove=!0},this)}},Player.prototype.hit=function(){this.moveTween&&this.moveTween.stop(),this.canMove=!1},Player.prototype.incraseSpeed=function(){this.moveDuration>=100&&(this.moveDuration-=.025)};var BasicGame={};BasicGame.Boot=function(){},BasicGame.Boot.prototype={init:function(){this.input.maxPointers=1,this.stage.disableVisibilityChange=!0},preload:function(){this.load.atlas("preloader","res/preloader.png","res/preloader.json")},create:function(){this.stage.backgroundColor="#393E46",this.state.start("Preload")}},BasicGame.Game=function(a){this.player=null,this.obstacles=null,this.stop=!0,this.timer=null,this.spawnDelay=1e3},BasicGame.Game.prototype={init:function(a){this.config=a,game.renderer.roundPixels=!0,game.physics.startSystem(Phaser.Physics.ARCADE)},create:function(){var a=this;a.player=new Player(game,.5,game.world.height-75),a.obstacles=new Obstacles(game),game.input.onDown.add(a.player.move,a.player),a.timer=new Phaser.Timer(game),a.timer.add(a.spawnDelay,function(){a.stop=!1}),a.timer.start()},update:function(){var a=this;a.stop?a.timer.update(game.time.time):(a.obstacles.spawn(),a.player.incraseSpeed()),game.physics.arcade.collide(a.player,a.obstacles,function(){a.stop=!0,a.player.hit(),a.obstacles.stop(),a.state.start("Game",!0,!1,a.config)})},shutdown:function(){game.input.onDown.removeAll(),game.time.events.remove(self.timer),this.player.destroy(),this.obstacles.destroy(),this.stop=!0}},BasicGame.Menu=function(){},BasicGame.Menu.prototype={init:function(a){a||(a={}),this.config=a},create:function(){this.startClick()},update:function(){},startClick:function(){this.state.start("Game",!0,!1,this.config)}},BasicGame.Preload=function(){this.preloadBar=null,this.ready=!1},BasicGame.Preload.prototype={preload:function(){this.preloadBar=this.add.sprite(.5*game.width,.5*game.height,"preloader",0),this.preloadBar.anchor.set(.5,.5);var a=[],b=0;for(b;33>b;b++)a[b]=b;this.preloadBar.animations.add("loading",a,60,!0),this.preloadBar.play("loading"),this.load.onLoadComplete.addOnce(this.onLoadComplete,this)},create:function(){this.preloadBar.cropEnabled=!1},update:function(){this.state.start("Menu")},onLoadComplete:function(){this.ready=!0}};var game=new Phaser.Game(300,420,Phaser.Canvas,"game_cont");game.state.add("Boot",BasicGame.Boot),game.state.add("Preload",BasicGame.Preload),game.state.add("Menu",BasicGame.Menu),game.state.add("Game",BasicGame.Game),game.state.start("Boot");